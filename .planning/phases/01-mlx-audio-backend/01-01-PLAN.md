---
phase: 01-mlx-audio-backend
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pedantic_parakeet/backends/__init__.py
  - pedantic_parakeet/backends/base.py
  - pedantic_parakeet/backends/registry.py
autonomous: true
must_haves:
  truths:
    - "Backend and capability metadata resolve for curated model IDs"
    - "Curated STT models are listable for CLI display"
    - "Unknown model IDs return a clear validation error"
  artifacts:
    - path: "pedantic_parakeet/backends/base.py"
      provides: "Backend enum and capability contracts"
    - path: "pedantic_parakeet/backends/registry.py"
      provides: "Curated model registry with resolvers"
    - path: "pedantic_parakeet/backends/__init__.py"
      provides: "Public backend exports"
  key_links:
    - from: "pedantic_parakeet/backends/registry.py"
      to: "pedantic_parakeet/backends/base.py"
      via: "ModelInfo/STTCapabilities types"
      pattern: "from .*base import"
---

<objective>
Define backend capability contracts and a curated model registry for mlx-audio support.

Purpose: Centralize model metadata and backend selection before implementation work.
Output: Backend contracts and registry helpers for CLI/Transcriber.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/codebase/STRUCTURE.md
@.planning/codebase/ARCHITECTURE.md
@pedantic_parakeet/transcriber.py
@pedantic_parakeet/cli.py
@pyproject.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define backend capability contracts</name>
  <files>pedantic_parakeet/backends/base.py, pedantic_parakeet/backends/__init__.py</files>
  <action>
    - Create `Backend` enum with values `parakeet` and `mlx-audio` (string values for CLI).
    - Add `STTCapabilities` dataclass with flags: `supports_timestamps`, `supports_language_bias`, `supports_language_hint`, `supports_chunking`.
    - Add `ModelInfo` dataclass with `model_id`, `backend`, `capabilities`, and optional `description`.
    - Define `BaseTranscriber` protocol with `model_id`, `capabilities`, and `transcribe(...) -> TranscriptionResult`.
    - Export these symbols from `backends/__init__.py`.
  </action>
  <verify>python -c "from pedantic_parakeet.backends import Backend, STTCapabilities, ModelInfo"</verify>
  <done>Backend contracts import cleanly and describe required capabilities.</done>
</task>

<task type="auto">
  <name>Task 2: Build curated model registry and resolver helpers</name>
  <files>pedantic_parakeet/backends/registry.py</files>
  <action>
    - Create a curated `MODEL_REGISTRY` for STT models:
      - `mlx-community/parakeet-tdt-0.6b-v3` -> backend `parakeet`, timestamps true, language_bias true, chunking true.
      - `mlx-community/parakeet-tdt-0.6b-v2` -> backend `mlx-audio`, timestamps true, language_hint false, chunking true.
      - `mlx-community/whisper-large-v3-turbo-asr-fp16` -> backend `mlx-audio`, timestamps true, language_hint true, chunking false.
      - `mlx-community/Voxtral-Mini-3B-2507-bf16` -> backend `mlx-audio`, timestamps false, language_hint true, chunking false.
    - Provide helpers: `get_model_info(model_id)`, `list_models(backend=None)`, and `resolve_model(model_id)` that raises `ValueError` with supported model IDs when unknown.
    - Include model descriptions in `ModelInfo` for CLI display.
  </action>
  <verify>python -c "from pedantic_parakeet.backends.registry import list_models; assert list_models()"</verify>
  <done>Curated models resolve to backend + capability metadata, unknown IDs raise ValueError.</done>
</task>

</tasks>

<verification>
Run `python -c "from pedantic_parakeet.backends.registry import list_models; print(list_models())"` and confirm curated entries appear.
</verification>

<success_criteria>
- Registry returns ModelInfo for all curated STT model IDs.
- Unknown model IDs raise ValueError with supported list.
- Backend/capability types are importable from `pedantic_parakeet.backends`.
</success_criteria>

<output>
After completion, create `.planning/phases/01-mlx-audio-backend/01-01-SUMMARY.md`
</output>
